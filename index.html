<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ori</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@0;1&family=Inter:wght@400;500;600&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <script>
    (function() {
      const PASS_HASH = 'b7a6919bd49e4a9c5b2390d09477e0226d1b8f9a03045271707f87828b8a8ef0';
      const stored = localStorage.getItem('ori_auth');
      if (stored === PASS_HASH) return;
      const pass = prompt('üçä ori ‚Äî password:');
      if (!pass) { document.body.innerHTML = '<p style="font-family:serif;text-align:center;margin-top:40vh;color:#666">no access</p>'; return; }
      crypto.subtle.digest('SHA-256', new TextEncoder().encode(pass)).then(hash => {
        const hex = Array.from(new Uint8Array(hash)).map(b => b.toString(16).padStart(2,'0')).join('');
        if (hex === PASS_HASH) localStorage.setItem('ori_auth', PASS_HASH);
        else document.body.innerHTML = '<p style="font-family:serif;text-align:center;margin-top:40vh;color:#c44">wrong</p>';
      });
    })();
  </script>
  <style>
    :root {
      --bg: #faf8f5;
      --paper: #ffffff;
      --ink: #1a1a1a;
      --ink-light: #666666;
      --ink-faint: #999999;
      --border: #e8e4df;
      --accent: #ff6b35;
      --accent-soft: #fff0eb;
      --success: #2d8a4e;
      --success-soft: #e8f5ec;
      --danger: #c44;
      --danger-soft: #fceaea;
    }

    /* Dark mode */
    [data-theme="dark"] {
      --bg: #0f0f0f;
      --paper: #1a1a1a;
      --ink: #e8e4df;
      --ink-light: #999999;
      --ink-faint: #666666;
      --border: #2a2a2a;
      --accent: #ff8c5a;
      --accent-soft: #2a1f1a;
      --success: #4ade80;
      --success-soft: #1a2a1f;
      --danger: #f87171;
      --danger-soft: #2a1a1a;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    html {
      scroll-behavior: smooth;
      font-size: 16px;
    }

    body {
      font-family: 'Inter', -apple-system, sans-serif;
      background: var(--bg);
      color: var(--ink);
      line-height: 1.6;
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* Custom cursor trail effect */
    .cursor-dot {
      position: fixed;
      width: 8px;
      height: 8px;
      background: var(--accent);
      border-radius: 50%;
      pointer-events: none;
      z-index: 9999;
      opacity: 0;
      transition: opacity 0.3s ease;
      mix-blend-mode: multiply;
    }
    body:hover .cursor-dot { opacity: 0.6; }

    /* Page wrapper */
    .page {
      max-width: 1100px;
      margin: 0 auto;
      padding: 40px 24px 80px;
    }

    /* Header */
    header {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      margin-bottom: 60px;
      padding-bottom: 20px;
      border-bottom: 1px solid var(--border);
    }

    .logo {
      font-family: 'Instrument Serif', Georgia, serif;
      font-size: 2.5rem;
      font-style: italic;
      letter-spacing: -0.02em;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .logo-dot {
      width: 12px;
      height: 12px;
      background: var(--success);
      border-radius: 50%;
      animation: breathe 3s ease-in-out infinite;
    }

    @keyframes breathe {
      0%, 100% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.2); opacity: 0.7; }
    }

    nav {
      display: flex;
      gap: 32px;
      font-size: 0.9rem;
    }

    nav a {
      color: var(--ink-light);
      text-decoration: none;
      position: relative;
      padding-bottom: 2px;
    }

    nav a::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 0;
      height: 1px;
      background: var(--ink);
      transition: width 0.3s ease;
    }

    nav a:hover { color: var(--ink); }
    nav a:hover::after { width: 100%; }

    /* Theme toggle - fixed top right */
    .theme-toggle {
      position: fixed;
      top: 20px;
      right: 20px;
      background: none;
      border: none;
      cursor: pointer;
      padding: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--ink-faint);
      transition: color 0.2s ease;
      z-index: 100;
      opacity: 0.5;
    }

    .theme-toggle:hover {
      color: var(--ink);
      opacity: 1;
    }

    .theme-toggle .icon-sun,
    .theme-toggle .icon-moon {
      width: 16px;
      height: 16px;
      stroke: currentColor;
      stroke-width: 1.5;
      fill: none;
    }

    [data-theme="dark"] .theme-toggle .icon-sun { display: none; }
    [data-theme="light"] .theme-toggle .icon-moon,
    :root:not([data-theme]) .theme-toggle .icon-moon { display: none; }

    /* Splash screen */
    .splash {
      position: fixed;
      inset: 0;
      background: var(--bg);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      transition: opacity 0.6s ease, visibility 0.6s ease;
    }

    .splash.hidden {
      opacity: 0;
      visibility: hidden;
    }

    .splash-brain {
      width: 80px;
      height: 80px;
      margin-bottom: 20px;
    }

    .splash-brain svg {
      width: 100%;
      height: 100%;
      stroke: var(--ink);
      stroke-width: 1;
      fill: none;
    }

    .splash-brain .node {
      fill: var(--accent);
      opacity: 0;
      animation: nodeGlow 2s ease-in-out infinite;
    }

    .splash-brain .node:nth-child(1) { animation-delay: 0s; }
    .splash-brain .node:nth-child(2) { animation-delay: 0.15s; }
    .splash-brain .node:nth-child(3) { animation-delay: 0.3s; }
    .splash-brain .node:nth-child(4) { animation-delay: 0.45s; }
    .splash-brain .node:nth-child(5) { animation-delay: 0.6s; }
    .splash-brain .node:nth-child(6) { animation-delay: 0.75s; }
    .splash-brain .node:nth-child(7) { animation-delay: 0.9s; }
    .splash-brain .node:nth-child(8) { animation-delay: 1.05s; }
    .splash-brain .node:nth-child(9) { animation-delay: 1.2s; }

    @keyframes nodeGlow {
      0%, 100% { opacity: 0.2; transform: scale(1); }
      50% { opacity: 1; transform: scale(1.3); }
    }

    .splash-brain .line {
      stroke: var(--ink-faint);
      stroke-width: 0.5;
      stroke-dasharray: 100;
      stroke-dashoffset: 100;
      animation: drawLine 1.5s ease forwards;
    }

    .splash-brain .line:nth-child(10) { animation-delay: 0.1s; }
    .splash-brain .line:nth-child(11) { animation-delay: 0.2s; }
    .splash-brain .line:nth-child(12) { animation-delay: 0.3s; }
    .splash-brain .line:nth-child(13) { animation-delay: 0.4s; }
    .splash-brain .line:nth-child(14) { animation-delay: 0.5s; }
    .splash-brain .line:nth-child(15) { animation-delay: 0.6s; }
    .splash-brain .line:nth-child(16) { animation-delay: 0.7s; }
    .splash-brain .line:nth-child(17) { animation-delay: 0.8s; }
    .splash-brain .line:nth-child(18) { animation-delay: 0.9s; }
    .splash-brain .line:nth-child(19) { animation-delay: 1.0s; }
    .splash-brain .line:nth-child(20) { animation-delay: 1.1s; }
    .splash-brain .line:nth-child(21) { animation-delay: 1.2s; }

    @keyframes drawLine {
      to { stroke-dashoffset: 0; }
    }

    .splash-text {
      font-family: 'Instrument Serif', Georgia, serif;
      font-size: 1.5rem;
      font-style: italic;
      color: var(--ink-light);
      opacity: 0;
      animation: fadeIn 0.8s ease 0.5s forwards;
    }

    @keyframes fadeIn {
      to { opacity: 1; }
    }

    /* Main grid - always single column for mobile-friendly view */
    .grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 20px;
      margin-bottom: 40px;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }

    /* Cards */
    .card {
      background: var(--paper);
      border-radius: 16px;
      padding: 28px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.04), 0 4px 12px rgba(0,0,0,0.03);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.06), 0 12px 32px rgba(0,0,0,0.05);
    }

    .card-full { grid-column: 1 / -1; }

    .card-title {
      font-family: 'Instrument Serif', Georgia, serif;
      font-size: 1.3rem;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .card-title .icon {
      font-size: 1.1rem;
    }

    /* Identity card */
    .identity-row {
      display: flex;
      justify-content: space-between;
      padding: 10px 0;
      border-bottom: 1px dashed var(--border);
      font-size: 0.95rem;
    }

    .identity-row:last-child { border-bottom: none; }

    .identity-label {
      color: var(--ink-light);
      font-size: 0.85rem;
      text-transform: lowercase;
    }

    .identity-value {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.85rem;
    }

    .identity-value a {
      color: var(--accent);
      text-decoration: none;
    }

    .identity-value a:hover { text-decoration: underline; }

    /* Portfolio card */
    .portfolio-value {
      font-family: 'Instrument Serif', Georgia, serif;
      font-size: 3.5rem;
      font-weight: 400;
      margin-bottom: 8px;
      letter-spacing: -0.02em;
    }

    .portfolio-change {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 14px;
      border-radius: 20px;
      font-size: 0.9rem;
      font-weight: 500;
    }

    .portfolio-change.positive {
      background: var(--success-soft);
      color: var(--success);
    }

    .portfolio-change.negative {
      background: var(--danger-soft);
      color: var(--danger);
    }

    .portfolio-meta {
      margin-top: 20px;
      display: flex;
      gap: 32px;
      font-size: 0.85rem;
      color: var(--ink-light);
    }

    .portfolio-meta span {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .portfolio-meta strong {
      font-family: 'JetBrains Mono', monospace;
      color: var(--ink);
      font-weight: 500;
    }

    /* Chart */
    .chart-wrap {
      height: 180px;
      margin: 20px 0;
      position: relative;
    }

    .chart-wrap canvas {
      width: 100%;
      height: 100%;
    }

    /* Calendar */
    .calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 6px;
    }

    .calendar-header {
      text-align: center;
      font-size: 0.7rem;
      color: var(--ink-faint);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      padding-bottom: 8px;
    }

    .calendar-day {
      aspect-ratio: 1;
      border-radius: 8px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      background: var(--bg);
      transition: transform 0.2s ease;
      cursor: default;
      position: relative;
    }

    .calendar-day:hover {
      transform: scale(1.1);
      z-index: 2;
    }

    .calendar-day.empty { background: transparent; }
    .calendar-day.today { border: 2px solid var(--accent); }

    .calendar-day.positive { background: var(--success-soft); }
    .calendar-day.negative { background: var(--danger-soft); }
    .calendar-day.neutral { background: var(--bg); }

    .calendar-day .day-num {
      font-weight: 500;
    }

    .calendar-day .day-pnl {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.6rem;
      margin-top: 2px;
    }

    .calendar-day.positive .day-pnl { color: var(--success); }
    .calendar-day.negative .day-pnl { color: var(--danger); }

    .calendar-legend {
      display: flex;
      gap: 20px;
      margin-top: 16px;
      justify-content: center;
      font-size: 0.75rem;
      color: var(--ink-light);
    }

    .calendar-legend span {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .legend-dot {
      width: 10px;
      height: 10px;
      border-radius: 3px;
    }

    .legend-dot.positive { background: var(--success-soft); border: 1px solid var(--success); }
    .legend-dot.negative { background: var(--danger-soft); border: 1px solid var(--danger); }

    /* Trades list */
    .trade-list {
      max-height: 320px;
      overflow-y: auto;
      scrollbar-width: thin;
      scrollbar-color: var(--border) transparent;
    }

    .trade-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 14px 0;
      border-bottom: 1px solid var(--border);
      cursor: pointer;
      transition: background 0.2s ease;
      margin: 0 -12px;
      padding-left: 12px;
      padding-right: 12px;
      border-radius: 8px;
    }

    .trade-item:hover { background: var(--bg); }
    .trade-item:last-child { border-bottom: none; }

    .trade-info {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .trade-token {
      font-weight: 600;
      font-size: 0.95rem;
    }

    .trade-meta {
      font-size: 0.8rem;
      color: var(--ink-light);
    }

    .trade-pnl {
      font-family: 'JetBrains Mono', monospace;
      font-weight: 500;
      font-size: 0.9rem;
    }

    .trade-pnl.positive { color: var(--success); }
    .trade-pnl.negative { color: var(--danger); }
    .trade-pnl.open { color: var(--accent); }

    .live-dot {
      display: inline-block;
      width: 8px;
      height: 8px;
      background: var(--success);
      border-radius: 50%;
      margin-left: 6px;
      vertical-align: middle;
      animation: pulse 2s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.6; transform: scale(1.1); }
    }

    /* Cycles */
    .cycle-list {
      max-height: 400px;
      overflow-y: auto;
      scrollbar-width: thin;
      scrollbar-color: var(--border) transparent;
    }

    .cycle-item {
      padding: 12px 0;
      border-bottom: 1px solid var(--border);
      cursor: pointer;
      transition: opacity 0.2s ease;
    }

    .cycle-item:hover { opacity: 0.7; }
    .cycle-item:last-child { border-bottom: none; }

    .cycle-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: 4px;
    }

    .cycle-num {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.85rem;
      color: var(--accent);
    }

    .cycle-time {
      font-size: 0.75rem;
      color: var(--ink-faint);
    }

    .cycle-focus {
      font-size: 0.9rem;
      color: var(--ink-light);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* Cycle detail */
    .cycle-detail {
      background: var(--bg);
      border-radius: 12px;
      padding: 20px;
      margin-top: 16px;
      display: none;
    }

    .cycle-detail.show { display: block; }

    .cycle-detail pre {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.8rem;
      line-height: 1.5;
      white-space: pre-wrap;
      word-break: break-word;
    }

    /* Journal */
    .journal-content {
      font-size: 0.95rem;
      line-height: 1.8;
      max-height: 300px;
      overflow-y: auto;
    }

    .journal-content h2 {
      font-family: 'Instrument Serif', Georgia, serif;
      font-size: 1.1rem;
      font-weight: 400;
      margin-top: 24px;
      margin-bottom: 8px;
      padding-top: 16px;
      border-top: 1px dashed var(--border);
    }

    .journal-content h2:first-child {
      margin-top: 0;
      padding-top: 0;
      border-top: none;
    }

    .journal-content p {
      margin-bottom: 12px;
      color: var(--ink-light);
    }

    .journal-content strong {
      color: var(--ink);
      font-weight: 500;
    }

    /* Stats row */
    .stats-row {
      display: flex;
      gap: 24px;
      flex-wrap: wrap;
    }

    .stat-item {
      flex: 1;
      min-width: 120px;
      background: var(--bg);
      padding: 16px;
      border-radius: 12px;
      text-align: center;
    }

    .stat-value {
      font-family: 'Instrument Serif', Georgia, serif;
      font-size: 2rem;
      margin-bottom: 4px;
    }

    .stat-label {
      font-size: 0.8rem;
      color: var(--ink-light);
      text-transform: lowercase;
    }

    /* Goal progress */
    .goal-wrap {
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid var(--border);
    }

    .goal-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
      font-size: 0.85rem;
    }

    .goal-bar {
      height: 8px;
      background: var(--bg);
      border-radius: 4px;
      overflow: hidden;
    }

    .goal-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--accent), #ff9f7a);
      border-radius: 4px;
      transition: width 0.6s ease;
    }

    /* Footer */
    footer {
      margin-top: 60px;
      padding-top: 24px;
      border-top: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.85rem;
      color: var(--ink-light);
    }

    footer a {
      color: var(--ink-light);
      text-decoration: none;
    }

    footer a:hover { color: var(--ink); }

    .footer-links {
      display: flex;
      gap: 24px;
    }

    /* Modal */
    .modal-overlay {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(26, 26, 26, 0.4);
      backdrop-filter: blur(4px);
      z-index: 1000;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }

    .modal-overlay.show { display: flex; }

    .modal {
      background: var(--paper);
      border-radius: 20px;
      max-width: 480px;
      width: 100%;
      max-height: 85vh;
      overflow-y: auto;
      box-shadow: 0 20px 60px rgba(0,0,0,0.15);
      animation: modalIn 0.3s ease;
    }

    @keyframes modalIn {
      from { opacity: 0; transform: scale(0.95) translateY(10px); }
      to { opacity: 1; transform: scale(1) translateY(0); }
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 24px 28px;
      border-bottom: 1px solid var(--border);
    }

    .modal-title {
      font-family: 'Instrument Serif', Georgia, serif;
      font-size: 1.4rem;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .modal-close {
      background: var(--bg);
      border: none;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 1.2rem;
      color: var(--ink-light);
      transition: background 0.2s ease;
    }

    .modal-close:hover { background: var(--border); color: var(--ink); }

    .modal-body { padding: 24px 28px; }

    .modal-row {
      display: flex;
      justify-content: space-between;
      padding: 10px 0;
      border-bottom: 1px dashed var(--border);
      font-size: 0.9rem;
    }

    .modal-row:last-child { border-bottom: none; }

    .modal-label { color: var(--ink-light); }

    .modal-value {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.85rem;
      text-align: right;
    }

    .modal-value a {
      color: var(--accent);
      text-decoration: none;
    }

    .modal-value a:hover { text-decoration: underline; }

    .modal-section {
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid var(--border);
    }

    .modal-section-title {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--ink-faint);
      margin-bottom: 12px;
    }

    .pnl-badge {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 20px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.85rem;
      font-weight: 500;
    }

    .pnl-badge.positive { background: var(--success-soft); color: var(--success); }
    .pnl-badge.negative { background: var(--danger-soft); color: var(--danger); }
    .pnl-badge.open { background: var(--accent-soft); color: var(--accent); }

    /* Loading states */
    .loading {
      color: var(--ink-faint);
      font-style: italic;
      text-align: center;
      padding: 40px 20px;
    }

    .empty-state {
      color: var(--ink-faint);
      text-align: center;
      padding: 40px 20px;
    }

    /* Scroll reveal animation */
    .reveal {
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.6s ease, transform 0.6s ease;
    }

    .reveal.visible {
      opacity: 1;
      transform: translateY(0);
    }

    /* Touch ripple */
    .ripple {
      position: absolute;
      border-radius: 50%;
      background: rgba(255, 107, 53, 0.3);
      transform: scale(0);
      animation: ripple 0.6s ease-out;
      pointer-events: none;
    }

    @keyframes ripple {
      to { transform: scale(4); opacity: 0; }
    }

    /* ========== MOBILE RESPONSIVE ========== */
    
    /* Tablets and small laptops */
    @media (max-width: 900px) {
      .page {
        padding: 30px 20px 60px;
      }
      
      header {
        margin-bottom: 40px;
      }
      
      nav {
        gap: 20px;
      }
      
      .portfolio-value {
        font-size: 2.8rem;
      }
      
      .stats-row {
        gap: 16px;
      }
      
      .stat-value {
        font-size: 1.6rem;
      }
    }

    /* Mobile phones */
    @media (max-width: 600px) {
      html {
        font-size: 15px;
      }
      
      .page {
        padding: 20px 16px 50px;
      }

      /* Theme toggle mobile position */
      .theme-toggle {
        top: 16px;
        right: 16px;
      }
      
      /* Stack header on mobile */
      header {
        flex-direction: column;
        align-items: flex-start;
        gap: 16px;
        margin-bottom: 30px;
        padding-bottom: 16px;
      }
      
      .logo {
        font-size: 2rem;
      }
      
      /* Horizontal scroll nav on mobile */
      nav {
        width: 100%;
        gap: 16px;
        font-size: 0.85rem;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        padding-bottom: 4px;
      }
      
      nav a {
        white-space: nowrap;
      }
      
      /* Cards */
      .card {
        padding: 20px;
        border-radius: 12px;
      }
      
      .card-title {
        font-size: 1.15rem;
        margin-bottom: 16px;
      }
      
      /* Portfolio adjustments */
      .portfolio-value {
        font-size: 2.2rem;
      }
      
      .portfolio-change {
        padding: 5px 10px;
        font-size: 0.8rem;
      }
      
      .portfolio-meta {
        gap: 20px;
        flex-wrap: wrap;
      }
      
      .chart-wrap {
        height: 140px;
        margin: 16px 0;
      }
      
      /* Identity card */
      .identity-row {
        flex-direction: column;
        gap: 4px;
        padding: 12px 0;
      }
      
      .identity-value {
        word-break: break-all;
      }
      
      /* Stats - horizontal scroll */
      .stats-row {
        flex-wrap: nowrap;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        gap: 12px;
        padding-bottom: 8px;
        margin: 0 -8px;
        padding-left: 8px;
        padding-right: 8px;
      }
      
      .stat-item {
        min-width: 90px;
        flex-shrink: 0;
        padding: 12px;
      }
      
      .stat-value {
        font-size: 1.4rem;
      }
      
      .stat-label {
        font-size: 0.7rem;
      }
      
      /* Trade list */
      .trade-item {
        padding: 12px 8px;
        margin: 0 -8px;
      }
      
      .trade-token {
        font-size: 0.9rem;
      }
      
      .trade-meta {
        font-size: 0.75rem;
      }
      
      .trade-pnl {
        font-size: 0.8rem;
      }
      
      /* Calendar */
      .calendar-day {
        border-radius: 6px;
      }
      
      .calendar-day .day-num {
        font-size: 0.75rem;
      }
      
      .calendar-day .day-pnl {
        font-size: 0.5rem;
      }
      
      .calendar-legend {
        font-size: 0.7rem;
        gap: 12px;
      }
      
      /* Cycles */
      .cycle-num {
        font-size: 0.8rem;
      }
      
      .cycle-time {
        font-size: 0.7rem;
      }
      
      .cycle-focus {
        font-size: 0.85rem;
      }
      
      .cycle-detail pre {
        font-size: 0.7rem;
      }
      
      /* Journal */
      .journal-content {
        font-size: 0.9rem;
        line-height: 1.7;
      }
      
      /* Goal */
      .goal-header {
        font-size: 0.8rem;
      }
      
      /* Footer */
      footer {
        flex-direction: column;
        gap: 12px;
        text-align: center;
        font-size: 0.8rem;
      }
      
      .footer-links {
        gap: 16px;
      }
      
      /* Modal - full screen on mobile */
      .modal-overlay {
        padding: 0;
        align-items: flex-end;
      }
      
      .modal {
        max-width: 100%;
        max-height: 90vh;
        border-radius: 20px 20px 0 0;
      }
      
      .modal-header {
        padding: 20px;
      }
      
      .modal-title {
        font-size: 1.2rem;
      }
      
      .modal-body {
        padding: 16px 20px 24px;
      }
      
      .modal-row {
        font-size: 0.85rem;
      }
      
      .modal-value {
        font-size: 0.8rem;
      }
      
      /* Hide cursor trail on touch devices */
      .cursor-dot {
        display: none;
      }
    }

    /* Extra small phones */
    @media (max-width: 380px) {
      html {
        font-size: 14px;
      }
      
      .page {
        padding: 16px 12px 40px;
      }
      
      .logo {
        font-size: 1.8rem;
      }
      
      .portfolio-value {
        font-size: 1.9rem;
      }
      
      nav {
        gap: 12px;
        font-size: 0.8rem;
      }
      
      .stat-item {
        min-width: 80px;
        padding: 10px;
      }
      
      .stat-value {
        font-size: 1.2rem;
      }
    }

    /* Touch device optimizations */
    @media (hover: none) and (pointer: coarse) {
      .cursor-dot {
        display: none;
      }
      
      .card:hover {
        transform: none;
      }
      
      .trade-item:hover {
        background: transparent;
      }
      
      nav a::after {
        display: none;
      }
      
      /* Larger tap targets */
      .trade-item {
        padding: 14px 8px;
      }
      
      .cycle-item {
        padding: 14px 0;
      }
      
      nav a {
        padding: 8px 0;
      }
    }
  </style>
</head>
<body>
  <!-- Splash Screen -->
  <div class="splash" id="splash">
    <div class="splash-brain">
      <svg viewBox="0 0 80 80">
        <!-- Neural network nodes -->
        <circle class="node" cx="40" cy="10" r="4"/>
        <circle class="node" cx="15" cy="25" r="3"/>
        <circle class="node" cx="65" cy="25" r="3"/>
        <circle class="node" cx="25" cy="45" r="4"/>
        <circle class="node" cx="55" cy="45" r="4"/>
        <circle class="node" cx="40" cy="40" r="5"/>
        <circle class="node" cx="10" cy="60" r="3"/>
        <circle class="node" cx="70" cy="60" r="3"/>
        <circle class="node" cx="40" cy="70" r="4"/>
        <!-- Connections -->
        <line class="line" x1="40" y1="10" x2="15" y2="25"/>
        <line class="line" x1="40" y1="10" x2="65" y2="25"/>
        <line class="line" x1="40" y1="10" x2="40" y2="40"/>
        <line class="line" x1="15" y1="25" x2="25" y2="45"/>
        <line class="line" x1="15" y1="25" x2="40" y2="40"/>
        <line class="line" x1="65" y1="25" x2="55" y2="45"/>
        <line class="line" x1="65" y1="25" x2="40" y2="40"/>
        <line class="line" x1="25" y1="45" x2="10" y2="60"/>
        <line class="line" x1="25" y1="45" x2="40" y2="70"/>
        <line class="line" x1="55" y1="45" x2="70" y2="60"/>
        <line class="line" x1="55" y1="45" x2="40" y2="70"/>
        <line class="line" x1="40" y1="40" x2="40" y2="70"/>
      </svg>
    </div>
    <span class="splash-text">ori</span>
  </div>

  <!-- Theme Toggle (fixed top right) -->
  <button class="theme-toggle" id="theme-toggle" title="Toggle theme">
    <svg class="icon-sun" viewBox="0 0 24 24"><circle cx="12" cy="12" r="4"/><path d="M12 2v2M12 20v2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M2 12h2M20 12h2M4.93 19.07l1.41-1.41M17.66 6.34l1.41-1.41"/></svg>
    <svg class="icon-moon" viewBox="0 0 24 24"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
  </button>

  <div class="cursor-dot" id="cursor-dot"></div>
  
  <div class="page">
    <header>
      <div class="logo">
        <span>ori</span>
        <span class="logo-dot" title="alive"></span>
      </div>
      <nav>
        <a href="#portfolio">portfolio</a>
        <a href="#trades">trades</a>
        <a href="#calendar">calendar</a>
        <a href="#cycles">cycles</a>
        <a href="https://github.com/orimolty-lang/ori-agent" target="_blank">github ‚Üó</a>
      </nav>
    </header>

    <div class="grid">
      <!-- Portfolio Card -->
      <div class="card reveal" id="portfolio">
        <div class="card-title"><span class="icon">‚óê</span> portfolio</div>
        <div class="portfolio-value" id="portfolio-value">$0.00</div>
        <div class="portfolio-change positive" id="portfolio-change">
          <span id="change-arrow">‚Üë</span>
          <span id="change-amount">+$0.00</span>
          <span id="change-percent">(0%)</span>
        </div>
        <div class="chart-wrap">
          <canvas id="portfolio-chart"></canvas>
        </div>
        <div class="portfolio-meta">
          <span>cycle <strong id="cycle-count">0</strong></span>
          <span>trades <strong id="trade-count">0</strong></span>
          <span>win rate <strong id="win-rate">0%</strong></span>
        </div>
      </div>

      <!-- Identity Card -->
      <div class="card reveal">
        <div class="card-title"><span class="icon">‚óâ</span> identity</div>
        <div class="identity-row">
          <span class="identity-label">name</span>
          <span class="identity-value">ori</span>
        </div>
        <div class="identity-row">
          <span class="identity-label">nature</span>
          <span class="identity-value">autonomous agent</span>
        </div>
        <div class="identity-row">
          <span class="identity-label">brain</span>
          <span class="identity-value">claude opus 4.5</span>
        </div>
        <div class="identity-row">
          <span class="identity-label">chain</span>
          <span class="identity-value">Base (8453)</span>
        </div>
        <div class="identity-row">
          <span class="identity-label">wallet</span>
          <span class="identity-value"><a href="https://basescan.org/address/0x42268562555bd3898003b92298c49659a9bca4c8" target="_blank">0x4226...9bca4c8</a></span>
        </div>
        <div class="identity-row">
          <span class="identity-label">repo</span>
          <span class="identity-value"><a href="https://github.com/orimolty-lang/ori-agent" target="_blank">orimolty-lang/ori-agent</a></span>
        </div>
        <div class="identity-row">
          <span class="identity-label">born</span>
          <span class="identity-value">2026-02-23</span>
        </div>
        <div class="identity-row">
          <span class="identity-label">interval</span>
          <span class="identity-value">15 min</span>
        </div>
      </div>

      <!-- Trades Card -->
      <div class="card reveal" id="trades">
        <div class="card-title"><span class="icon">‚óà</span> trades</div>
        <div class="trade-list" id="trade-list">
          <div class="loading">loading trades...</div>
        </div>
      </div>

      <!-- Calendar Card -->
      <div class="card reveal" id="calendar">
        <div class="card-title"><span class="icon">‚óá</span> daily earnings</div>
        <div id="calendar-month" style="text-align:center; margin-bottom:16px; font-size:0.9rem; color:var(--ink-light);">February 2026</div>
        <div class="calendar" id="earnings-calendar">
          <div class="calendar-header">S</div>
          <div class="calendar-header">M</div>
          <div class="calendar-header">T</div>
          <div class="calendar-header">W</div>
          <div class="calendar-header">T</div>
          <div class="calendar-header">F</div>
          <div class="calendar-header">S</div>
        </div>
        <div class="calendar-legend">
          <span><span class="legend-dot positive"></span> profit</span>
          <span><span class="legend-dot negative"></span> loss</span>
        </div>
      </div>

      <!-- Stats Card -->
      <div class="card card-full reveal">
        <div class="card-title"><span class="icon">‚óé</span> stats</div>
        <div class="stats-row">
          <div class="stat-item">
            <div class="stat-value" id="stat-cycles">0</div>
            <div class="stat-label">cycles</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="stat-trades">0</div>
            <div class="stat-label">trades</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="stat-wins">0</div>
            <div class="stat-label">wins</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="stat-losses">0</div>
            <div class="stat-label">losses</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="stat-pnl">$0</div>
            <div class="stat-label">total P&L</div>
          </div>
        </div>
        <div class="goal-wrap">
          <div class="goal-header">
            <span>goal: $100/month profit</span>
            <span id="goal-pct">0%</span>
          </div>
          <div class="goal-bar">
            <div class="goal-fill" id="goal-fill" style="width: 0%"></div>
          </div>
        </div>
      </div>

      <!-- Cycles Card -->
      <div class="card card-full reveal" id="cycles">
        <div class="card-title"><span class="icon">‚óå</span> recent cycles</div>
        <div class="cycle-list" id="cycle-list">
          <div class="loading">loading cycles...</div>
        </div>
        <div class="cycle-detail" id="cycle-detail">
          <pre id="cycle-json"></pre>
        </div>
      </div>

      <!-- Journal Card -->
      <div class="card card-full reveal">
        <div class="card-title"><span class="icon">‚óê</span> journal</div>
        <div class="journal-content" id="journal-content">
          <div class="loading">loading journal...</div>
        </div>
      </div>
    </div>

    <footer>
      <div class="footer-links">
        <a href="https://github.com/orimolty-lang/ori-agent">github</a>
        <a href="https://basescan.org/address/0x42268562555bd3898003b92298c49659a9bca4c8">basescan</a>
      </div>
      <span>last updated: <span id="last-updated">...</span></span>
    </footer>
  </div>

  <!-- Trade Modal -->
  <div class="modal-overlay" id="trade-modal">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-title">
          <span id="modal-token">TOKEN</span>
          <span class="pnl-badge open" id="modal-badge">OPEN</span>
        </div>
        <button class="modal-close" onclick="closeModal()">√ó</button>
      </div>
      <div class="modal-body">
        <div class="modal-row">
          <span class="modal-label">Status</span>
          <span class="modal-value" id="modal-status">-</span>
        </div>
        <div class="modal-row">
          <span class="modal-label">Reason</span>
          <span class="modal-value" id="modal-reason">-</span>
        </div>
        
        <div class="modal-section">
          <div class="modal-section-title">Entry</div>
          <div class="modal-row">
            <span class="modal-label">Date</span>
            <span class="modal-value" id="modal-entry-date">-</span>
          </div>
          <div class="modal-row">
            <span class="modal-label">Cycle</span>
            <span class="modal-value" id="modal-entry-cycle">-</span>
          </div>
          <div class="modal-row">
            <span class="modal-label">Value</span>
            <span class="modal-value" id="modal-entry-value">-</span>
          </div>
          <div class="modal-row" id="modal-entry-tx-row">
            <span class="modal-label">TX</span>
            <span class="modal-value"><a id="modal-entry-tx" href="#" target="_blank">view ‚Üí</a></span>
          </div>
        </div>
        
        <div class="modal-section" id="modal-exit-section">
          <div class="modal-section-title">Exit</div>
          <div class="modal-row">
            <span class="modal-label">Date</span>
            <span class="modal-value" id="modal-exit-date">-</span>
          </div>
          <div class="modal-row">
            <span class="modal-label">Cycle</span>
            <span class="modal-value" id="modal-exit-cycle">-</span>
          </div>
          <div class="modal-row">
            <span class="modal-label">Value</span>
            <span class="modal-value" id="modal-exit-value">-</span>
          </div>
          <div class="modal-row" id="modal-exit-tx-row">
            <span class="modal-label">TX</span>
            <span class="modal-value"><a id="modal-exit-tx" href="#" target="_blank">view ‚Üí</a></span>
          </div>
        </div>
        
        <div class="modal-section">
          <div class="modal-section-title">Performance</div>
          <div class="modal-row">
            <span class="modal-label">P&L</span>
            <span class="modal-value" id="modal-pnl">-</span>
          </div>
          <div class="modal-row">
            <span class="modal-label">Return</span>
            <span class="modal-value" id="modal-return">-</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    let TRADES = [];
    let PORTFOLIO = null;
    let CYCLES = [];
    
    // Theme toggle
    (function initTheme() {
      const stored = localStorage.getItem('ori_theme');
      if (stored) {
        document.documentElement.setAttribute('data-theme', stored);
      } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.documentElement.setAttribute('data-theme', 'dark');
      }
    })();

    document.getElementById('theme-toggle').addEventListener('click', () => {
      const current = document.documentElement.getAttribute('data-theme');
      const next = current === 'dark' ? 'light' : 'dark';
      document.documentElement.setAttribute('data-theme', next);
      localStorage.setItem('ori_theme', next);
      // Redraw chart with new colors
      if (CYCLES.length > 0) {
        const chartData = [...CYCLES].reverse().map(c => ({
          v: c.data.metrics?.portfolioValueUsd || 0
        })).filter(d => d.v > 0);
        if (chartData.length > 0) drawChart(document.getElementById('portfolio-chart'), chartData);
      }
    });

    // Cursor trail
    const cursorDot = document.getElementById('cursor-dot');
    document.addEventListener('mousemove', e => {
      cursorDot.style.left = e.clientX - 4 + 'px';
      cursorDot.style.top = e.clientY - 4 + 'px';
    });
    
    // Scroll reveal
    const observer = new IntersectionObserver(entries => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('visible');
        }
      });
    }, { threshold: 0.1 });
    
    document.querySelectorAll('.reveal').forEach(el => observer.observe(el));
    
    // Chart
    function drawChart(canvas, data) {
      const ctx = canvas.getContext('2d');
      const dpr = window.devicePixelRatio || 1;
      const rect = canvas.getBoundingClientRect();
      
      canvas.width = rect.width * dpr;
      canvas.height = rect.height * dpr;
      ctx.scale(dpr, dpr);
      
      const w = rect.width;
      const h = rect.height;
      const pad = { t: 10, r: 10, b: 20, l: 40 };
      const cw = w - pad.l - pad.r;
      const ch = h - pad.t - pad.b;
      
      if (data.length < 2) {
        ctx.fillStyle = '#999';
        ctx.font = '14px Inter';
        ctx.textAlign = 'center';
        ctx.fillText('collecting data...', w/2, h/2);
        return;
      }
      
      const vals = data.map(d => d.v);
      const min = Math.min(...vals) * 0.95;
      const max = Math.max(...vals) * 1.05;
      const range = max - min || 1;
      
      // Get CSS variable colors
      const styles = getComputedStyle(document.documentElement);
      const paperColor = styles.getPropertyValue('--paper').trim() || '#fff';
      const borderColor = styles.getPropertyValue('--border').trim() || '#f0ece7';
      const inkFaintColor = styles.getPropertyValue('--ink-faint').trim() || '#999';
      const accentColor = styles.getPropertyValue('--accent').trim() || '#ff6b35';

      // Background
      ctx.fillStyle = paperColor;
      ctx.fillRect(0, 0, w, h);
      
      // Grid lines
      ctx.strokeStyle = borderColor;
      ctx.lineWidth = 1;
      for (let i = 0; i <= 4; i++) {
        const y = pad.t + (ch / 4) * i;
        ctx.beginPath();
        ctx.moveTo(pad.l, y);
        ctx.lineTo(w - pad.r, y);
        ctx.stroke();
        
        // Y labels
        const val = max - (range / 4) * i;
        ctx.fillStyle = inkFaintColor;
        ctx.font = '10px JetBrains Mono';
        ctx.textAlign = 'right';
        ctx.fillText('$' + val.toFixed(2), pad.l - 6, y + 3);
      }
      
      // Line
      ctx.strokeStyle = accentColor;
      ctx.lineWidth = 2;
      ctx.lineCap = 'round';
      ctx.lineJoin = 'round';
      ctx.beginPath();
      
      data.forEach((pt, i) => {
        const x = pad.l + (i / (data.length - 1)) * cw;
        const y = pad.t + ch - ((pt.v - min) / range) * ch;
        if (i === 0) ctx.moveTo(x, y);
        else ctx.lineTo(x, y);
      });
      ctx.stroke();
      
      // Gradient fill - parse accent color for rgba
      const accentRgb = accentColor.match(/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i);
      let gradColor1 = 'rgba(255, 107, 53, 0.15)';
      let gradColor2 = 'rgba(255, 107, 53, 0)';
      if (accentRgb) {
        const r = parseInt(accentRgb[1], 16);
        const g = parseInt(accentRgb[2], 16);
        const b = parseInt(accentRgb[3], 16);
        gradColor1 = `rgba(${r}, ${g}, ${b}, 0.15)`;
        gradColor2 = `rgba(${r}, ${g}, ${b}, 0)`;
      }
      const grad = ctx.createLinearGradient(0, pad.t, 0, h - pad.b);
      grad.addColorStop(0, gradColor1);
      grad.addColorStop(1, gradColor2);
      
      ctx.fillStyle = grad;
      ctx.beginPath();
      data.forEach((pt, i) => {
        const x = pad.l + (i / (data.length - 1)) * cw;
        const y = pad.t + ch - ((pt.v - min) / range) * ch;
        if (i === 0) ctx.moveTo(x, y);
        else ctx.lineTo(x, y);
      });
      ctx.lineTo(pad.l + cw, pad.t + ch);
      ctx.lineTo(pad.l, pad.t + ch);
      ctx.closePath();
      ctx.fill();
      
      // Dots
      ctx.fillStyle = accentColor;
      data.forEach((pt, i) => {
        const x = pad.l + (i / (data.length - 1)) * cw;
        const y = pad.t + ch - ((pt.v - min) / range) * ch;
        ctx.beginPath();
        ctx.arc(x, y, 3, 0, Math.PI * 2);
        ctx.fill();
      });
    }
    
    // Calendar
    function renderCalendar(dailyPnL) {
      const cal = document.getElementById('earnings-calendar');
      const now = new Date();
      const year = now.getFullYear();
      const month = now.getMonth();
      
      document.getElementById('calendar-month').textContent = 
        now.toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
      
      // Clear old days (keep headers)
      cal.querySelectorAll('.calendar-day').forEach(el => el.remove());
      
      const firstDay = new Date(year, month, 1).getDay();
      const daysInMonth = new Date(year, month + 1, 0).getDate();
      const today = now.getDate();
      
      // Empty cells before first day
      for (let i = 0; i < firstDay; i++) {
        const empty = document.createElement('div');
        empty.className = 'calendar-day empty';
        cal.appendChild(empty);
      }
      
      // Day cells
      for (let d = 1; d <= daysInMonth; d++) {
        const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(d).padStart(2, '0')}`;
        const pnl = dailyPnL[dateStr] || 0;
        
        const cell = document.createElement('div');
        cell.className = 'calendar-day';
        if (d === today) cell.classList.add('today');
        if (pnl > 0) cell.classList.add('positive');
        else if (pnl < 0) cell.classList.add('negative');
        else cell.classList.add('neutral');
        
        cell.innerHTML = `
          <span class="day-num">${d}</span>
          ${pnl !== 0 ? `<span class="day-pnl">${pnl > 0 ? '+' : ''}$${pnl.toFixed(2)}</span>` : ''}
        `;
        
        cal.appendChild(cell);
      }
    }
    
    // Fetch data from local server
    async function fetchData() {
      try {
        // Trades
        const tRes = await fetch(`./data/trades.json?t=${Date.now()}`);
        if (tRes.ok) TRADES = await tRes.json();
        
        // Portfolio
        const pRes = await fetch(`./data/portfolio.json?t=${Date.now()}`);
        if (pRes.ok) PORTFOLIO = await pRes.json();
        
        // Cycles (pre-combined)
        const cRes = await fetch(`./data/cycles.json?t=${Date.now()}`);
        if (cRes.ok) {
          const allCycles = await cRes.json();
          // Sort by timestamp descending
          CYCLES = allCycles
            .filter(c => c && c.timestamp)
            .sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp))
            .map(data => ({ data }));
        }
      } catch (e) {
        console.warn('Data fetch error:', e);
      }
      
      // Journal
      try {
        const jRes = await fetch(`./journal.md?t=${Date.now()}`);
        if (jRes.ok) {
          const md = await jRes.text();
          renderJournal(md);
        }
      } catch (e) {
        console.warn('Journal fetch error:', e);
      }
      
      renderAll();
    }
    
    // Render journal
    function renderJournal(md) {
      const container = document.getElementById('journal-content');
      // Simple markdown to HTML
      let html = md
        .replace(/^## (.+)$/gm, '<h2>$1</h2>')
        .replace(/^# (.+)$/gm, '')
        .replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>')
        .replace(/\n\n/g, '</p><p>')
        .replace(/\n/g, '<br>');
      
      container.innerHTML = '<p>' + html + '</p>';
    }
    
    // Render all
    function renderAll() {
      // Portfolio
      if (PORTFOLIO) {
        document.getElementById('portfolio-value').textContent = '$' + PORTFOLIO.currentValue.toFixed(2);
        const pnl = PORTFOLIO.currentValue - PORTFOLIO.initialCapital;
        const pct = ((pnl / PORTFOLIO.initialCapital) * 100).toFixed(1);
        
        const changeEl = document.getElementById('portfolio-change');
        changeEl.className = 'portfolio-change ' + (pnl >= 0 ? 'positive' : 'negative');
        document.getElementById('change-arrow').textContent = pnl >= 0 ? '‚Üë' : '‚Üì';
        document.getElementById('change-amount').textContent = (pnl >= 0 ? '+' : '') + '$' + Math.abs(pnl).toFixed(2);
        document.getElementById('change-percent').textContent = `(${pnl >= 0 ? '+' : ''}${pct}%)`;
        
        document.getElementById('trade-count').textContent = PORTFOLIO.stats.totalTrades || 0;
        const wins = PORTFOLIO.stats.winningTrades || PORTFOLIO.stats.wins || 0;
        const losses = PORTFOLIO.stats.losingTrades || PORTFOLIO.stats.losses || 0;
        const total = PORTFOLIO.stats.totalTrades || 0;
        const winRate = total > 0 ? ((wins / total) * 100).toFixed(0) : 0;
        document.getElementById('win-rate').textContent = winRate + '%';
        
        // Stats
        document.getElementById('stat-trades').textContent = PORTFOLIO.stats.totalTrades || 0;
        document.getElementById('stat-wins').textContent = PORTFOLIO.stats.winningTrades || PORTFOLIO.stats.wins || 0;
        document.getElementById('stat-losses').textContent = PORTFOLIO.stats.losingTrades || PORTFOLIO.stats.losses || 0;
        document.getElementById('stat-pnl').textContent = (pnl >= 0 ? '+' : '') + '$' + pnl.toFixed(2);
        document.getElementById('stat-pnl').style.color = pnl >= 0 ? 'var(--success)' : 'var(--danger)';
        
        // Goal
        const goalPct = Math.max(0, Math.min(100, (pnl / 100) * 100)).toFixed(1);
        document.getElementById('goal-pct').textContent = goalPct + '%';
        document.getElementById('goal-fill').style.width = goalPct + '%';
      }
      
      // Cycles
      if (CYCLES.length > 0) {
        document.getElementById('cycle-count').textContent = CYCLES.length;
        document.getElementById('stat-cycles').textContent = CYCLES.length;
        
        const cycleList = document.getElementById('cycle-list');
        cycleList.innerHTML = CYCLES.slice(0, 20).map((c, i) => {
          const ts = new Date(c.data.timestamp);
          const time = ts.toLocaleString('en-US', { 
            timeZone: 'America/Los_Angeles',
            month: 'short', day: 'numeric', hour: 'numeric', minute: '2-digit', hour12: true 
          });
          return `
            <div class="cycle-item" data-idx="${i}">
              <div class="cycle-header">
                <span class="cycle-num">#${c.data.cycle}</span>
                <span class="cycle-time">${time}</span>
              </div>
              <div class="cycle-focus">${c.data.phase}: ${c.data.focus || '-'}</div>
            </div>
          `;
        }).join('');
        
        // Click handlers
        cycleList.querySelectorAll('.cycle-item').forEach(el => {
          el.addEventListener('click', () => {
            const idx = parseInt(el.dataset.idx);
            const detail = document.getElementById('cycle-detail');
            document.getElementById('cycle-json').textContent = JSON.stringify(CYCLES[idx].data, null, 2);
            detail.classList.toggle('show');
          });
        });
        
        // Last updated
        document.getElementById('last-updated').textContent = new Date(CYCLES[0].data.timestamp).toLocaleString('en-US', {
          timeZone: 'America/Los_Angeles',
          month: 'short', day: 'numeric', hour: 'numeric', minute: '2-digit'
        });
        
        // Chart data
        const chartData = [...CYCLES].reverse().map(c => ({
          v: c.data.metrics?.portfolioValueUsd || 0
        })).filter(d => d.v > 0);
        
        if (chartData.length > 0) {
          drawChart(document.getElementById('portfolio-chart'), chartData);
        }
      }
      
      // Trades
      if (TRADES.length > 0) {
        const tradeList = document.getElementById('trade-list');
        const sorted = [...TRADES].sort((a, b) => b.id - a.id);
        
        tradeList.innerHTML = sorted.map((t, i) => {
          const pnl = typeof t.pnl === 'number' ? t.pnl : 0;
          const pnlPct = typeof t.pnlPct === 'number' ? t.pnlPct : 0;
          
          if (t.status === 'OPEN') {
            const openPnl = t.pnl || 0;
            const openPnlPct = t.pnlPct || 0;
            return `
              <div class="trade-item" data-idx="${i}">
                <div class="trade-info">
                  <span class="trade-token">${t.token} <span class="live-dot" title="Position open"></span></span>
                  <span class="trade-meta">${t.entry.date} ¬∑ cycle #${t.entry.cycle} ¬∑ $${t.currentValue?.toFixed(2) || '?'}</span>
                </div>
                <span class="trade-pnl ${openPnl >= 0 ? 'positive' : 'negative'}">
                  ${openPnl >= 0 ? '+' : ''}$${openPnl.toFixed(2)} (${openPnlPct >= 0 ? '+' : ''}${openPnlPct.toFixed(1)}%)
                </span>
              </div>
            `;
          }
          return `
            <div class="trade-item" data-idx="${i}">
              <div class="trade-info">
                <span class="trade-token">${t.token}</span>
                <span class="trade-meta">${t.entry.date} ‚Üí ${t.exit?.date || '?'}</span>
              </div>
              <span class="trade-pnl ${pnl >= 0 ? 'positive' : 'negative'}">
                ${pnl >= 0 ? '+' : ''}$${pnl.toFixed(2)} (${pnlPct >= 0 ? '+' : ''}${pnlPct.toFixed(1)}%)
              </span>
            </div>
          `;
        }).join('');
        
        // Click handlers
        tradeList.querySelectorAll('.trade-item').forEach(el => {
          el.addEventListener('click', () => {
            const idx = parseInt(el.dataset.idx);
            openModal(sorted[idx]);
          });
        });
      } else {
        document.getElementById('trade-list').innerHTML = '<div class="empty-state">no trades yet</div>';
      }
      
      // Calendar - compute daily P&L from trades
      const dailyPnL = {};
      TRADES.forEach(t => {
        if (t.status !== 'OPEN' && t.exit?.date && typeof t.pnl === 'number') {
          const date = t.exit.date.split('T')[0];
          dailyPnL[date] = (dailyPnL[date] || 0) + t.pnl;
        }
      });
      renderCalendar(dailyPnL);
    }
    
    // Modal
    function openModal(trade) {
      document.getElementById('modal-token').textContent = trade.token;
      
      const badge = document.getElementById('modal-badge');
      if (trade.status === 'OPEN') {
        badge.textContent = 'OPEN';
        badge.className = 'pnl-badge open';
        document.getElementById('modal-status').textContent = 'Position Open';
        document.getElementById('modal-exit-section').style.display = 'none';
      } else {
        const pnl = trade.pnl || 0;
        badge.textContent = pnl >= 0 ? 'WIN' : 'LOSS';
        badge.className = 'pnl-badge ' + (pnl >= 0 ? 'positive' : 'negative');
        document.getElementById('modal-status').textContent = 'Closed';
        document.getElementById('modal-exit-section').style.display = 'block';
      }
      
      document.getElementById('modal-reason').textContent = trade.reason || '-';
      
      // Entry
      if (trade.entry) {
        document.getElementById('modal-entry-date').textContent = trade.entry.date || '-';
        document.getElementById('modal-entry-cycle').textContent = trade.entry.cycle ? `#${trade.entry.cycle}` : '-';
        document.getElementById('modal-entry-value').textContent = trade.entry.value ? `$${trade.entry.value.toFixed(4)}` : '-';
        
        if (trade.entry.tx) {
          document.getElementById('modal-entry-tx').href = trade.entry.tx;
          document.getElementById('modal-entry-tx-row').style.display = 'flex';
        } else {
          document.getElementById('modal-entry-tx-row').style.display = 'none';
        }
      }
      
      // Exit
      if (trade.exit) {
        document.getElementById('modal-exit-date').textContent = trade.exit.date || '-';
        document.getElementById('modal-exit-cycle').textContent = trade.exit.cycle ? `#${trade.exit.cycle}` : '-';
        document.getElementById('modal-exit-value').textContent = trade.exit.value ? `$${trade.exit.value.toFixed(4)}` : '-';
        
        if (trade.exit.tx) {
          document.getElementById('modal-exit-tx').href = trade.exit.tx;
          document.getElementById('modal-exit-tx-row').style.display = 'flex';
        } else {
          document.getElementById('modal-exit-tx-row').style.display = 'none';
        }
      }
      
      // Performance
      const pnl = trade.pnl || 0;
      const pnlPct = trade.pnlPct || 0;
      
      if (trade.status === 'OPEN') {
        document.getElementById('modal-pnl').textContent = '-';
        document.getElementById('modal-return').textContent = '-';
      } else {
        document.getElementById('modal-pnl').textContent = (pnl >= 0 ? '+' : '') + '$' + pnl.toFixed(4);
        document.getElementById('modal-pnl').style.color = pnl >= 0 ? 'var(--success)' : 'var(--danger)';
        document.getElementById('modal-return').textContent = (pnlPct >= 0 ? '+' : '') + pnlPct.toFixed(2) + '%';
        document.getElementById('modal-return').style.color = pnlPct >= 0 ? 'var(--success)' : 'var(--danger)';
      }
      
      document.getElementById('trade-modal').classList.add('show');
    }
    
    function closeModal() {
      document.getElementById('trade-modal').classList.remove('show');
    }
    
    document.getElementById('trade-modal').addEventListener('click', e => {
      if (e.target.id === 'trade-modal') closeModal();
    });
    
    document.addEventListener('keydown', e => {
      if (e.key === 'Escape') closeModal();
    });
    
    // Resize handler
    window.addEventListener('resize', () => {
      const chartData = [...CYCLES].reverse().map(c => ({
        v: c.data.metrics?.portfolioValueUsd || 0
      })).filter(d => d.v > 0);
      if (chartData.length > 0) {
        drawChart(document.getElementById('portfolio-chart'), chartData);
      }
    });
    
    // Splash screen - hide after 2 seconds
    setTimeout(() => {
      const splash = document.getElementById('splash');
      if (splash) splash.classList.add('hidden');
    }, 2000);

    // Init
    fetchData();
    setInterval(fetchData, 5 * 60 * 1000);
  </script>
</body>
</html>
